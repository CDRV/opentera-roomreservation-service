<div class="page-container">
  <h1>{{title}}</h1>

  <form [formGroup]="reservationForm">
    <h3>Informations</h3>
    <app-site-selector></app-site-selector>
    <app-user-selector [selectedUserUUID]="selectedUserUUID" [form]="reservationForm"></app-user-selector>
    <app-room-selector [form]="reservationForm"></app-room-selector>

    <mat-form-field appearance="outline">
      <mat-label>Nom de la réservation</mat-label>
      <input matInput formControlName="name" [placeholder]="title">
      <mat-error>
        {{required}}
      </mat-error>
    </mat-form-field>

    <h3>Date et heures</h3>

    <app-datetime-selector [label]="'Début'" [default]="startTime" [form]="reservationForm"
                           [controlName]="startTimeControlName" [minDate]="today"></app-datetime-selector>
    <app-datetime-selector [label]="'Fin'" [default]="endTime" [form]="reservationForm"
                           [controlName]="endTimeControlName"
                           [minDate]="startTime"></app-datetime-selector>

    <div *ngIf="reservationForm.hasError('timesOverlapping')" class="period overlap">
      <mat-icon>close</mat-icon>
      Cette période est déjà occupée.
    </div>
    <div *ngIf="!reservationForm.hasError('timesOverlapping')" class="period free">
      <mat-icon>check</mat-icon>
      Cette période est libre.
    </div>

    <h3>Séance</h3>
    <p>
      Indiquer le projet auquel la séance est associée pour ajouter un type de séance et un ou des participants.
    </p>
    <app-project-selector [idReservationProject]="idReservationProject" [required]="hasSession"
                          [form]="reservationForm"></app-project-selector>
    <app-session-type-selector [idEventSessionType]="session?.id_session_type" [required]="hasSession"
                               [form]="reservationForm"></app-session-type-selector>

    <app-selected-participants [selectedParticipants]="sessionParticipants"
                               (participantsChange)="participantsChange($event)"></app-selected-participants>
  </form>

  <div class="buttons" mat-dialog-actions>
    <button mat-button *ngIf="canDelete" (click)="delete()">
      <mat-icon mat-list-icon>delete</mat-icon>
      <span>Supprimer</span>
    </button>
    <button mat-button [disabled]=!canSave (click)="validate()">
      <mat-icon mat-list-icon>save</mat-icon>
      <span>Sauvegarder</span>
    </button>
    <button mat-button (click)="cancel()">
      <mat-icon mat-list-icon>close</mat-icon>
      <span>Annuler</span>
    </button>
  </div>
</div>
